# 高可用存储架构
*看吧，所有的高性能和高可用，都是针对数据来的*  
存储高可用的本质：是通过将数据复制到多个设备，通过***冗余***的方式来实现高可用  
**复杂度在哪?**
>复杂度主要体现在如何应对复制延迟和中断导致的不一致问题。任何架构都这样，比如kafka redis 等

**考虑的点是？**
- 数据如何复制?
    >Mysql 和 redis 貌似都是开子线程来进行复制，父线程继续执行读写任务.
- 各节点职责?
- 复制延迟与复制中断问题?

## 双机架构
### 主备
注意和主从的区别，主从是为了高性能，这个是为了高可用  
最简单的存储高可用方案，几乎所有的存储系统都提供，比如 Redis Mysql MongoDb等  
#### 工作方式  
主负责读写，备来备份。当主挂的时候，备来当主  
#### 优缺点
**优点:**  
简单  
**缺点:**  
- 备平时不用，资源浪费啊.
- 出故障时，如何变主？一般是人工干预，但人工处理效率太低了，半夜故障找不到人  

#### 使用场景
学生管理系统，员工管理系统等。因为这系统数据一般更新频率低，即使出错也能再人工找回来  

### 主从
![img_1.png](./assets/主从.png)  
和主备的差别，就是从机负责了读业务，充分利用了资源。 高可用+高性能  

#### 优缺点
**优点:**  
- 主故障，读操作依然可用
- 相对于主备，充分利用资源

**缺点:**  
- 客户端感知主从关系了啊, 客户端需要把写给主，读负载均衡?或都给从。复杂度就上来了，业务侵入耦合严重
- 重要的是，如果数据复制延迟大，出现了数据不一致问题
- 故障时，还是需要人工干预

#### 使用场景
读多写少的。例如论坛，新闻网站啥的









